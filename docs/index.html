<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@webcrypto/storage</title><meta name="description" content="Documentation for @webcrypto/storage"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@webcrypto/storage</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1>@webcrypto/storage</h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#web-crypto-storage" id="web-crypto-storage" style="color: inherit; text-decoration: none;">
  <h1>Web Crypto Storage</h1>
</a>
<p>
  <a
    href="https://github.com/willgm/web-crypto-storage/actions"
    target="_blank"
  >
    <img
      alt="Build"
      src="https://img.shields.io/github/workflow/status/willgm/web-crypto-storage/CI"
    />
  </a>
  <a
    href="https://www.npmjs.com/package/@webcrypto/storage"
    target="_blank"
  >
    <img
      alt="Version"
      src="https://img.shields.io/github/package-json/v/willgm/web-crypto-storage"
    />
  </a>
  <a
    href="https://willgm.github.io/web-crypto-storage/demo/index.html"
    target="_blank"
  >
    <img
      alt="Demo"
      src="https://img.shields.io/badge/demo-online-green"
    />
  </a>
  <a
    href="https://github.com/willgm/web-crypto-storage/blob/master/LICENSE"
    target="_blank"
  >
    <img
      src="https://img.shields.io/badge/license-MIT-blue.svg"
      alt="web-crypto-storage is released under the MIT license"
    />
  </a>
  <a
    href="https://github.com/willgm/web-crypto-storage/graphs/contributors"
    target="_blank"
  >
    <img
      alt="Contributors"
      src="https://img.shields.io/github/contributors/willgm/web-crypto-storage.svg"
    />
  </a>
</p>

<blockquote>
<p>A tiny promise-based crypto keyval storage using IndexedDB and the native Web Crypto API</p>
</blockquote>
<p>This is a tiny promise-based crypto keyval storage using IndexedDB and the native <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Crypto_API">Web Crypto API</a>, having just two small dependencies: <a href="https://github.com/jakearchibald/idb">IDB</a> for a better devxp using IndexedDB and <a href="https://github.com/willgm/web-crypto-tools">Web Crypto Tools</a> for a better devxp using the Web Crypto API.</p>
<p>This crypto storage not only encrypt/decrypt the data but also checks for integrity, verifying if the stored data were manually updated. It uses the default crypto algorithms on <a href="https://github.com/willgm/web-crypto-tools">Web Crypto Tools</a>, which are <code>PBKDF2</code> for hashing and key derivation and <code>AES-GCM</code> for encryption, with the option to customize the used salt and encrypt iterations. The base crypto key is safely used in memory and never stored locally, if at the next session the base crypto key is lost, the data cannot be decrypted back to the original value.</p>
<p>This project depends on the browser implementation of <a href="https://caniuse.com/#feat=cryptography">Crypto API</a> and <a href="https://caniuse.com/#feat=textencoder">TextEncoder API</a>, which are both current implemented on all green browsers. If you do need to support any older browser, you should look for available polyfills.</p>

<a href="#house-demo" id="house-demo" style="color: inherit; text-decoration: none;">
  <h2>:house: Demo</h2>
</a>
<p>You can play with a <a href="https://willgm.github.io/web-crypto-storage/demo/index.html">full feature demo</a> on our Github Pages.</p>

<a href="#gear-usage" id="gear-usage" style="color: inherit; text-decoration: none;">
  <h2>:gear: Usage</h2>
</a>

<a href="#install-it-at-your-project" id="install-it-at-your-project" style="color: inherit; text-decoration: none;">
  <h3>Install it at your project</h3>
</a>
<pre><code class="language-bash"><span class="hl-0">npm install @webcrypto/storage --save</span>
</code></pre>

<a href="#store-your-crypto-data" id="store-your-crypto-data" style="color: inherit; text-decoration: none;">
  <h3>Store your crypto data</h3>
</a>
<pre><code class="language-ts"><span class="hl-1">// Create a new instance of the crypto storage and give it a key!</span><br/><span class="hl-1">// Be aware that normally you would never hard code the key like in this example,</span><br/><span class="hl-1">// take a look at the FAQ for more information on how to handle crypto keys.</span><br/><span class="hl-2">const</span><span class="hl-0"> </span><span class="hl-3">cryptoStore</span><span class="hl-0"> = </span><span class="hl-2">new</span><span class="hl-0"> </span><span class="hl-4">CryptoStorage</span><span class="hl-0">(</span><span class="hl-5">&#39;my crypto key&#39;</span><span class="hl-0">);</span><br/><br/><span class="hl-1">// Secure store your data locally fully encrypted</span><br/><span class="hl-2">const</span><span class="hl-0"> </span><span class="hl-3">originalValue</span><span class="hl-0"> = </span><span class="hl-5">&#39;any data value&#39;</span><span class="hl-0">;</span><br/><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-7">cryptoStore</span><span class="hl-0">.</span><span class="hl-4">set</span><span class="hl-0">(</span><span class="hl-5">&#39;data key&#39;</span><span class="hl-0">, </span><span class="hl-7">originalValue</span><span class="hl-0">);</span><br/><br/><span class="hl-1">// Look at the browser dev tools from IndexedDb,</span><br/><span class="hl-1">// you will not be able to read the data key or value.</span><br/><span class="hl-1">// Then, retrieve your original data decrypted again:</span><br/><span class="hl-2">const</span><span class="hl-0"> </span><span class="hl-3">decryptedValue</span><span class="hl-0"> = </span><span class="hl-6">await</span><span class="hl-0"> </span><span class="hl-7">cryptoStore</span><span class="hl-0">.</span><span class="hl-4">get</span><span class="hl-0">(</span><span class="hl-5">&#39;data key&#39;</span><span class="hl-0">);</span><br/><span class="hl-4">expect</span><span class="hl-0">(</span><span class="hl-7">decryptedValue</span><span class="hl-0">).</span><span class="hl-4">toEqual</span><span class="hl-0">(</span><span class="hl-7">originalValue</span><span class="hl-0">);</span>
</code></pre>

<a href="#book-documentation" id="book-documentation" style="color: inherit; text-decoration: none;">
  <h2>:book: Documentation</h2>
</a>
<p>You should check our GitHub Pages for <a href="https://willgm.github.io/web-crypto-storage/">all available APIs and options</a>.</p>
<p>There is a <a href="https://github.com/willgm/web-crypto-storage/tree/master/demo">full feature example of use</a> at the code base. The <a href="https://github.com/willgm/web-crypto-storage/tree/master/test">test cases</a> are also quite readable and can be used as an example for every possible use of the public API.</p>
<p>This project is heavily inspired on <a href="https://twitter.com/ttaubert">Tim Taubert</a>&#39;s talk at JSConf EU: <a href="https://www.youtube.com/watch?v=yf4m9LdO1zI">Keeping secrets with JavaScript</a>, if you want to better understand what happens under the hood, then I highly recommend for you to watch it out.</p>

<a href="#contributing" id="contributing" style="color: inherit; text-decoration: none;">
  <h3>Contributing</h3>
</a>
<p>Please take a look at our <a href="https://github.com/willgm/web-crypto-storage/blob/master/CONTRIBUTING.md">Contributing Guide</a> to find out how to contribute to this project.</p>

<a href="#crypto-key-faq" id="crypto-key-faq" style="color: inherit; text-decoration: none;">
  <h3>Crypto Key FAQ</h3>
</a>

<a href="#what-should-i-use-as-the-crypto-key" id="what-should-i-use-as-the-crypto-key" style="color: inherit; text-decoration: none;">
  <h4>What should I use as the crypto key?</h4>
</a>
<p>There is no perfect answer to this question, it depends on your objective using this library and the application itself. If you do want to have strong security and make as difficult as possible to someone not authorized to access the data, then the crypto key should be unique per user, something strong that only the user knows and it is never stored anywhere out of his mind, as the <strong>user password</strong>. But it is not the only possible strategy, you can do any sort of server integration to obtain a crypto key, by session or any other thing that makes sense to your product logic or application platform.</p>

<a href="#where-should-i-store-the-crypto-key" id="where-should-i-store-the-crypto-key" style="color: inherit; text-decoration: none;">
  <h4>Where should I store the crypto key?</h4>
</a>
<p>If you really want to have your data protected, then the crypto key should never be stored in the browser, ideally should be something that you never store anywhere and just your user knows, like his password. But for some apps it doesn&#39;t make sense to use the user password or other user input as crypto key, then would be better to use some server integration to store and obtain the key when needed.</p>

<a href="#what-about-hard-coded-key-at-the-app-bundle" id="what-about-hard-coded-key-at-the-app-bundle" style="color: inherit; text-decoration: none;">
  <h4>What about hard coded key at the app bundle?</h4>
</a>
<p>The only scenario that it can make sense is if you just don&#39;t want to make obvious what you are storing on the browser, but you are not really worried if an advanced user go all the way through to decrypt the data. Please consider a better strategy that makes sense to your application.</p>

<a href="#how-does-this-library-handles-and-stores-the-crypto-key" id="how-does-this-library-handles-and-stores-the-crypto-key" style="color: inherit; text-decoration: none;">
  <h4>How does this library handles and stores the crypto key?</h4>
</a>
<p>This library doesn&#39;t store the crypto key anywhere, not even in memory, &#39;cause the first thing that this library does when it receives the given key is to derivate it to a new one, which will be actually used to encrypt/decrypt and kept in memory for this session. The new derived crypto key cannot be reverted to the original value, and is only kept in memory, so the original key will be necessary again at the next session, so that the stored encrypted data can be decrypted again.</p>

<a href="#license" id="license" style="color: inherit; text-decoration: none;">
  <h2>License</h2>
</a>
<p><a href="https://github.com/willgm/web-crypto-storage/blob/master/LICENSE">MIT</a></p>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Exports</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-class"><a href="classes/CryptoStorage.html" class="tsd-kind-icon">Crypto<wbr/>Storage</a></li><li class="tsd-kind-interface"><a href="interfaces/CryptoStorageConfig.html" class="tsd-kind-icon">Crypto<wbr/>Storage<wbr/>Config</a></li><li class="tsd-kind-type-alias"><a href="modules.html#InputData" class="tsd-kind-icon">Input<wbr/>Data</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li><li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static property</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>